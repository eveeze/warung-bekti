# Frontend Implementation Notes: Reports Module ðŸ“Š

This guide details how to consume the updated Reports API (`GET /api/v1/reports/daily`) and correctly display the data on the Dashboard.

## 1. Data Structure Overview

The backend now returns a **nested structure**. Please update your data mapping logic accordingly.

**Endpoint**: `GET /api/v1/reports/daily?date=YYYY-MM-DD`

```json
{
  "data": {
    "summary": { ... },       // Key Metrics
    "hourly_sales": [ ... ],  // For Line/Bar Chart
    "top_products": [ ... ]   // For List/Pie Chart
  }
}
```

## 2. Widget Mapping Guide

### A. Summary Cards (Top Row)

Map the `data.summary` object to your metric cards:

| UI Component        | JSON Field                    | Format        |
| :------------------ | :---------------------------- | :------------ |
| **Total Sales**     | `summary.total_sales`         | Currency (Rp) |
| **Profit**          | `summary.estimated_profit`    | Currency (Rp) |
| **Transactions**    | `summary.total_transactions`  | Number        |
| **Avg Transaction** | `summary.average_transaction` | Currency (Rp) |

> **âš ï¸ Important**: Do not access `data.total_sales` directly. It is now inside `data.summary`.

### B. Hourly Sales Chart (Line Chart)

Use `data.hourly_sales` for your sales trend chart.

- **X-Axis**: `hour` (Format: "09:00", "10:00")
- **Y-Axis**: `sales` (Currency)
- **Tooltip**: Show `transactions` count as well.

```js
// Example Mapping for Recharts
const chartData = response.data.hourly_sales.map((item) => ({
  time: `${item.hour}:00`,
  sales: item.sales,
  count: item.transactions,
}));
```

### C. Top Products (List / Horizontal Bar)

Use `data.top_products` to show the top 5 performing items.

- **Label**: `product_name`
- **Value**: `total_sales` (Primary) or `total_quantity` (Secondary)

## 3. Implementation Checklist

- [ ] **Auth Header**: Ensure `Authorization: Bearer <token>` is sent. (Requires Admin role).
- [ ] **Empty State**: If `hourly_sales` is empty (e.g., shop just opened), show a flat line or "No data yet" message.
- [ ] **Date Picker**: Passing `?date=` is optional. If omitted, it defaults to **Today**.
- [ ] **Loading State**: Show skeletons while fetching; reports might take 500ms-1s to generate.

## 4. Common Pitfalls

- **Undefined Error**: Accessing properties on `undefined` when data hasn't loaded. Always guard: `data?.summary?.total_sales`.
- **Timezone**: The `date` parameter expects simpler `YYYY-MM-DD`. Avoid sending full ISO strings with time components to prevent mismatch.

---

_Generated by Backend Team_
